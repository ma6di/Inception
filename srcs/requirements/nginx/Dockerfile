# ğŸ—ï¸ Use Debian slim base image (lightweight and supported by Inception rules)
# âœ… Subject requires building from Alpine or Debian â€” this is compliant
FROM debian:bullseye-slim

# ğŸ› ï¸ Install NGINX and OpenSSL for HTTPS support
# âœ… Required: NGINX must serve WordPress over HTTPS only (port 443)
RUN apt-get update && \
    apt-get install -y nginx openssl && \
    apt-get clean

# ğŸ“¥ Copy your custom NGINX config into the container
# âœ… Needed to define HTTPS server, TLS protocols, and reverse proxy to WordPress
COPY ./conf/nginx.conf /etc/nginx/nginx.conf

# ğŸ” Copy SSL certificate and private key into the container
# âœ… Required: the project must serve WordPress over HTTPS with TLSv1.2 or TLSv1.3
COPY ./conf/ssl/server.crt /etc/ssl/certs/server.crt
COPY ./conf/ssl/server.key /etc/ssl/private/server.key

# ğŸŒ Expose port 443 for secure HTTPS traffic
# âœ… This is the **only** public-facing port allowed in the project
EXPOSE 443

# ğŸš€ Run NGINX in the foreground
# âœ… Required: keeps container alive, and ensures it acts as the only entry point
CMD ["nginx", "-g", "daemon off;"]
